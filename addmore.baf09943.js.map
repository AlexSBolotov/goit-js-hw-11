{"mappings":"iiBAAA,IAAAA,EAAAC,EAAA,S,iEAOMC,EAAO,CACXC,aAAcC,SAASC,cAAc,gBACrCC,cAAeF,SAASC,cAAc,YACtCE,WAAYH,SAASC,cAAc,eAErCG,IAEA,IAAMC,EAAW,IAAI,EAAAC,EAAAC,UACjBC,EAAa,K,SAKFC,I,OAAAA,EAAfC,EAAAd,EAAA,CAAAc,EAAAC,GAAAC,MAAA,SAAAC,EAA4BC,G,yEAC1BA,EAAEC,iBACFC,IACAZ,IAEAC,EAASY,KAAO,EAChBZ,EAASa,MAAQJ,EAAEK,OAAOC,SAASC,YAAYC,M,kBAG3BjB,EAASkB,W,OAC3BC,EADSC,EAAAC,M,kDAGTC,EAAYF,EAAAG,I,2DAZWC,MAAAC,KAAAC,U,CAe3B,SAASP,EAAcQ,GACrB,GAAkB,IAAdA,EAAIC,MACN,MAAM,IAAIC,MACR,4EAGJ1B,EAAa2B,KAAKC,KAAKJ,EAAIK,UAAY,IACvCC,EAAAC,OAAOC,QAAQ,oBAAkCC,OAAdT,EAAIK,UAAU,aACjDK,EAAaV,EAAIW,MAEjB7C,EAAKC,aAAa6C,QACdZ,EAAIK,WAAa,GACnBjC,IAyCFN,EAAKK,WAAW0C,UAAUC,OAAO,Y,CAnCnC,SAASnB,EAAaoB,GACpB/B,IACAsB,EAAAC,OAAOS,QAAQD,EAAIE,Q,UAGNC,I,OAAAA,EAAfxC,EAAAd,EAAA,CAAAc,EAAAC,GAAAC,MAAA,SAAAC,EAAiCC,G,yEAC/BT,EAASY,MAAQ,E,SACCZ,EAASkB,W,OAC3BmB,EADSjB,EAAAC,KACQiB,MACjBQ,IAEI9C,EAASY,OAAST,IACpBJ,IACAkC,EAAAC,OAAOa,KAAM,+D,4CARevB,MAAAC,KAAAC,U,CAWhC,SAASf,IACPlB,EAAKI,cAAcmD,UAAY,E,CAEjC,SAASX,EAAaY,GACpBxD,EAAKI,cAAcqD,mBAAmB,YAIxC,SAAsBD,GACpB,OAAOA,EAAKE,KAAI,SAAAC,G,OAAQ,EAAAC,EAAAC,SAAiBF,E,IAAOG,KAAK,G,CALFC,CAAaP,IAQlD,IAAI5C,EAAAoD,GAAJ,CAAmB,aAAc,CAC7CC,aAAc,MACdC,aAAc,QAERC,S,CAKV,SAAS7D,IACPN,EAAKK,WAAW0C,UAAUqB,IAAI,Y,CAEhC,SAASf,IACPgB,OAAOC,SAAS,CACdC,IAAK,IACLC,SAAU,U,CA/EdxE,EAAKC,aAAawE,iBAAiB,U,SAGPzD,G,OAAbL,EAAYoB,MAAAC,KAAAC,U,IAF3BjC,EAAKK,WAAWoE,iBAAiB,S,SAwCAzD,G,OAAlBoC,EAAiBrB,MAAAC,KAAAC,U","sources":["src/js/addmore.js"],"sourcesContent":["import '../css/styles.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport { Notify } from 'notiflix';\nimport { CardsAPI } from './cardsAPI.js';\nimport galleryCardTmplt from '../templates/galleryCardTmplt.hbs';\n\nconst refs = {\n  searchFormEl: document.querySelector('.search-form'),\n  cardContainer: document.querySelector('.gallery'),\n  addMoreBtn: document.querySelector('.load-more'),\n};\nhideBtn();\n\nconst cardsAPI = new CardsAPI();\nlet totalPages = null;\n\nrefs.searchFormEl.addEventListener('submit', onFormSubmit);\nrefs.addMoreBtn.addEventListener('click', onAddMoreBtnClick);\n\nasync function onFormSubmit(e) {\n  e.preventDefault();\n  clearMarkup();\n  hideBtn();\n\n  cardsAPI.page = 1;\n  cardsAPI.query = e.target.elements.searchQuery.value;\n\n  try {\n    const res = await cardsAPI.getCards();\n    onFetchSucces(res);\n  } catch (err) {\n    onFetchError(err);\n  }\n}\nfunction onFetchSucces(res) {\n  if (res.total === 0) {\n    throw new Error(\n      'Sorry, there are no images matching your search query. Please try again.'\n    );\n  }\n  totalPages = Math.ceil(res.totalHits / 40);\n  Notify.success(`Hooray! We found ${res.totalHits} images.`);\n  renderMarkup(res.hits);\n\n  refs.searchFormEl.reset();\n  if (res.totalHits <= 40) {\n    hideBtn();\n    return;\n  }\n  showBtn();\n}\n\nfunction onFetchError(err) {\n  clearMarkup();\n  Notify.failure(err.message);\n}\n\nasync function onAddMoreBtnClick(e) {\n  cardsAPI.page += 1;\n  const res = await cardsAPI.getCards();\n  renderMarkup(res.hits);\n  addSmoothScroll();\n\n  if (cardsAPI.page === totalPages) {\n    hideBtn();\n    Notify.info(`We're sorry, but you've reached the end of search results.`);\n  }\n}\nfunction clearMarkup() {\n  refs.cardContainer.innerHTML = '';\n}\nfunction renderMarkup(data) {\n  refs.cardContainer.insertAdjacentHTML('beforeend', createMarkup(data));\n  insertLightox();\n}\n\nfunction createMarkup(data) {\n  return data.map(card => galleryCardTmplt(card)).join('');\n}\nfunction insertLightox() {\n  let gallery = new SimpleLightbox('.gallery a', {\n    captionsData: 'alt',\n    captionDelay: '250',\n  });\n  gallery.refresh();\n}\nfunction showBtn() {\n  refs.addMoreBtn.classList.remove('is-hidden');\n}\nfunction hideBtn() {\n  refs.addMoreBtn.classList.add('is-hidden');\n}\nfunction addSmoothScroll() {\n  window.scrollBy({\n    top: 430 * 2,\n    behavior: 'smooth',\n  });\n}\n// function renderMarkup(data) {\n//   const markup = data.map(card => galleryCardTmplt(card)).join('');\n//   refs.cardContainer.insertAdjacentHTML('beforeend', markup);\n//   let gallery = new SimpleLightbox('.gallery a', {\n//     captionsData: 'alt',\n//     captionDelay: '250',\n//   });\n//   gallery.refresh();\n// }\n// function showBtn(status) {\n//   refs.addMoreBtn.style.display = status;\n// }\n"],"names":["$bpxeT","parcelRequire","$a04b6ec5d5676d94$var$refs","searchFormEl","document","querySelector","cardContainer","addMoreBtn","$a04b6ec5d5676d94$var$hideBtn","$a04b6ec5d5676d94$var$cardsAPI","$gUBVK","CardsAPI","$a04b6ec5d5676d94$var$totalPages","$a04b6ec5d5676d94$var$_onFormSubmit","$parcel$interopDefault","$2TvXO","mark","_callee","e","preventDefault","$a04b6ec5d5676d94$var$clearMarkup","page","query","target","elements","searchQuery","value","getCards","$a04b6ec5d5676d94$var$onFetchSucces","_ctx","sent","$a04b6ec5d5676d94$var$onFetchError","t0","apply","this","arguments","res","total","Error","Math","ceil","totalHits","$6JpON","Notify","success","concat","$a04b6ec5d5676d94$var$renderMarkup","hits","reset","classList","remove","err","failure","message","$a04b6ec5d5676d94$var$_onAddMoreBtnClick","$a04b6ec5d5676d94$var$addSmoothScroll","info","innerHTML","data","insertAdjacentHTML","map","card","$crH6P","default","join","$a04b6ec5d5676d94$var$createMarkup","$5IjG7","captionsData","captionDelay","refresh","add","window","scrollBy","top","behavior","addEventListener"],"version":3,"file":"addmore.baf09943.js.map"}