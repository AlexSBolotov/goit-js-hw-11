{"mappings":"6kBAOA,MAAMA,EAAO,CACXC,aAAcC,SAASC,cAAc,gBACrCC,cAAeF,SAASC,cAAc,YACtCE,WAAYH,SAASC,cAAc,eAErCG,EAAQ,QAER,MAAMC,EAAW,IAAI,EAAAC,EAAAC,UACrB,IAAIC,EAAa,KAyDjB,SAASC,IACPX,EAAKI,cAAcQ,UAAY,E,CAEjC,SAASC,EAAaC,GACpB,MAAMC,EAASD,EAAKE,KAAIC,IAAQ,EAAAC,EAAAC,SAAiBF,KAAOG,KAAK,IAC7DpB,EAAKI,cAAciB,mBAAmB,YAAaN,GACrC,IAAIO,EAAAC,GAAJ,CAAmB,aAAc,CAC7CC,aAAc,MACdC,aAAc,QAERC,S,CAEV,SAASpB,EAAQqB,GACf3B,EAAKK,WAAWuB,MAAMC,QAAUF,C,CApElC3B,EAAKC,aAAa6B,iBAAiB,UAGnCC,eAA4BC,GAC1BA,EAAEC,iBACFtB,IACAL,EAAQ,QAERC,EAAS2B,KAAO,EAChB3B,EAAS4B,MAAQH,EAAEI,OAAOC,SAASC,YAAYC,MAE/C,KAOF,SAAuBC,GACrB,GAAkB,IAAdA,EAAIC,MACN,MAAM,IAAIC,MACR,4EAQJ,GALAhC,EAAaiC,KAAKC,KAAKJ,EAAIK,UAAY,IACvCC,EAAAC,OAAOC,QAAQ,oBAAoBR,EAAIK,qBACvChC,EAAa2B,EAAIS,MAEjBjD,EAAKC,aAAaiD,QACdV,EAAIK,WAAa,GAEnB,YADAvC,EAAQ,QAGVA,EAAQ,Q,CApBN6C,OADkB5C,EAAS6C,SAAS7C,EAAS4B,O,CAE7C,MAAOkB,IAsBX,SAAsBA,GACpB1C,IACAmC,EAAAC,OAAOO,QAAQD,EAAIE,Q,CAvBjBC,CAAaH,E,KAdjBrD,EAAKK,WAAWyB,iBAAiB,SAwCjCC,eAAiCC,GAC/BzB,EAAS2B,MAAQ,EAEjBrB,SADkBN,EAAS6C,SAAS7C,EAAS4B,QAC5Bc,MACjBQ,OAAOC,SAAS,CACdC,IAAK,IACLC,SAAU,WAGRrD,EAAS2B,OAASxB,IACpBJ,EAAQ,QACRwC,EAAAC,OAAOc,KAAK,8D","sources":["src/js/addmore.js"],"sourcesContent":["import '../css/styles.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport { Notify } from 'notiflix';\nimport { CardsAPI } from './cardsAPI.js';\nimport galleryCardTmplt from '../templates/galleryCardTmplt.hbs';\n\nconst refs = {\n  searchFormEl: document.querySelector('.search-form'),\n  cardContainer: document.querySelector('.gallery'),\n  addMoreBtn: document.querySelector('.load-more'),\n};\nshowBtn('none');\n\nconst cardsAPI = new CardsAPI();\nlet totalPages = null;\n\nrefs.searchFormEl.addEventListener('submit', onFormSubmit);\nrefs.addMoreBtn.addEventListener('click', onAddMoreBtnClick);\n\nasync function onFormSubmit(e) {\n  e.preventDefault();\n  clearMarkup();\n  showBtn('none');\n\n  cardsAPI.page = 1;\n  cardsAPI.query = e.target.elements.searchQuery.value;\n\n  try {\n    const res = await cardsAPI.getCards(cardsAPI.query);\n    onFetchSucces(res);\n  } catch (err) {\n    onFetchError(err);\n  }\n}\nfunction onFetchSucces(res) {\n  if (res.total === 0) {\n    throw new Error(\n      'Sorry, there are no images matching your search query. Please try again.'\n    );\n  }\n  totalPages = Math.ceil(res.totalHits / 40);\n  Notify.success(`Hooray! We found ${res.totalHits} images.`);\n  renderMarkup(res.hits);\n\n  refs.searchFormEl.reset();\n  if (res.totalHits <= 40) {\n    showBtn('none');\n    return;\n  }\n  showBtn('block');\n}\n\nfunction onFetchError(err) {\n  clearMarkup();\n  Notify.failure(err.message);\n}\n\nasync function onAddMoreBtnClick(e) {\n  cardsAPI.page += 1;\n  const res = await cardsAPI.getCards(cardsAPI.query);\n  renderMarkup(res.hits);\n  window.scrollBy({\n    top: 430 * 2,\n    behavior: 'smooth',\n  });\n\n  if (cardsAPI.page === totalPages) {\n    showBtn('none');\n    Notify.info(`We're sorry, but you've reached the end of search results.`);\n  }\n}\nfunction clearMarkup() {\n  refs.cardContainer.innerHTML = '';\n}\nfunction renderMarkup(data) {\n  const markup = data.map(card => galleryCardTmplt(card)).join('');\n  refs.cardContainer.insertAdjacentHTML('beforeend', markup);\n  let gallery = new SimpleLightbox('.gallery a', {\n    captionsData: 'alt',\n    captionDelay: '250',\n  });\n  gallery.refresh();\n}\nfunction showBtn(status) {\n  refs.addMoreBtn.style.display = status;\n}\n"],"names":["$6e0794e85d75a2ba$var$refs","searchFormEl","document","querySelector","cardContainer","addMoreBtn","$6e0794e85d75a2ba$var$showBtn","$6e0794e85d75a2ba$var$cardsAPI","$k0Hlu","CardsAPI","$6e0794e85d75a2ba$var$totalPages","$6e0794e85d75a2ba$var$clearMarkup","innerHTML","$6e0794e85d75a2ba$var$renderMarkup","data","markup","map","card","$5GVQI","default","join","insertAdjacentHTML","$parcel$interopDefault","$fZKcF","captionsData","captionDelay","refresh","status","style","display","addEventListener","async","e","preventDefault","page","query","target","elements","searchQuery","value","res","total","Error","Math","ceil","totalHits","$7Y9D8","Notify","success","hits","reset","$6e0794e85d75a2ba$var$onFetchSucces","getCards","err","failure","message","$6e0794e85d75a2ba$var$onFetchError","window","scrollBy","top","behavior","info"],"version":3,"file":"addmore.3dcad097.js.map"}