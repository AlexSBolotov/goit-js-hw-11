{"mappings":"6kBAOA,MAAMA,EAAO,CACXC,aAAcC,SAASC,cAAc,gBACrCC,cAAeF,SAASC,cAAc,YACtCE,WAAYH,SAASC,cAAc,eAErCH,EAAKK,WAAWC,UAAUC,IAAI,aAE9B,MAKMC,EAAW,IAAIC,sBAoCrB,SAAyBC,GACnBA,EAAQ,GAAGC,gBASjBC,iBACEC,EAASC,MAAQ,EAIjBC,SAFkBF,EAASG,YAEVC,MAEbJ,EAASC,OAASI,IACpBV,EAASW,UAAUnB,EAAKK,YAExBe,EAAAC,OAAOC,KAAK,8D,CAlBZC,E,GA3CY,CACdC,KAAM,KACNC,WAAY,oBACZC,UAAW,IAIPb,EAAW,IAAI,EAAAc,EAAAC,UACrB,IAAIV,EAAa,KAwDjB,SAASW,IACP7B,EAAKI,cAAc0B,UAAY,E,CAEjC,SAASf,EAAagB,GACpB,MAAMC,EAASD,EAAKE,KAAIC,IAAQ,EAAAC,EAAAC,SAAiBF,KAAOG,KAAK,IAC7DrC,EAAKI,cAAckC,mBAAmB,YAAaN,GACrC,IAAIO,EAAAC,GAAJ,CAAmB,aAAc,CAC7CC,aAAc,MACdC,aAAc,QAERC,S,CAhEV3C,EAAKC,aAAa2C,iBAAiB,UAEnChC,eAA4BiC,GAC1BA,EAAEC,iBACFjB,IAEAhB,EAASC,KAAO,EAChBD,EAASkC,MAAQF,EAAEG,OAAOC,SAASC,YAAYC,MAE/C,KAOF,SAAuBC,GACrB,GAAkB,IAAdA,EAAIC,MACN,MAAM,IAAIC,MACR,4EAOJ,GAJApC,EAAaqC,KAAKC,KAAKJ,EAAIK,UAAY,IACvCrC,EAAAC,OAAOqC,QAAQ,oBAAoBN,EAAIK,qBACvC1C,EAAaqC,EAAInC,MACjBjB,EAAKC,aAAa0D,QACdP,EAAIK,WAAa,GACnB,OAEFjD,EAASoD,QAAQ5D,EAAKK,W,CAlBpBwD,OADkBhD,EAASG,W,CAE3B,MAAO8C,IAwBX,SAAsBA,GACpBjC,IACAT,EAAAC,OAAO0C,QAAQD,EAAIE,Q,CAzBjBC,CAAaH,E","sources":["src/js/scroll.js"],"sourcesContent":["import '../css/styles.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport { Notify } from 'notiflix';\nimport { CardsAPI } from './cardsAPI';\nimport galleryCardTmplt from '../templates/galleryCardTmplt.hbs';\n\nconst refs = {\n  searchFormEl: document.querySelector('.search-form'),\n  cardContainer: document.querySelector('.gallery'),\n  addMoreBtn: document.querySelector('.load-more'),\n};\nrefs.addMoreBtn.classList.add('is-hidden');\n\nconst options = {\n  root: null,\n  rootMargin: '0px 0px 600px 0px',\n  threshold: 1,\n};\nconst observer = new IntersectionObserver(onScrollAddMore, options);\n\nconst cardsAPI = new CardsAPI();\nlet totalPages = null;\n\nrefs.searchFormEl.addEventListener('submit', onFormSubmit);\n\nasync function onFormSubmit(e) {\n  e.preventDefault();\n  clearMarkup();\n\n  cardsAPI.page = 1;\n  cardsAPI.query = e.target.elements.searchQuery.value;\n\n  try {\n    const res = await cardsAPI.getCards();\n    onFetchSucces(res);\n  } catch (err) {\n    onFetchError(err);\n  }\n}\nfunction onFetchSucces(res) {\n  if (res.total === 0) {\n    throw new Error(\n      'Sorry, there are no images matching your search query. Please try again.'\n    );\n  }\n  totalPages = Math.ceil(res.totalHits / 40);\n  Notify.success(`Hooray! We found ${res.totalHits} images.`);\n  renderMarkup(res.hits);\n  refs.searchFormEl.reset();\n  if (res.totalHits <= 40) {\n    return;\n  }\n  observer.observe(refs.addMoreBtn);\n}\nfunction onScrollAddMore(entries) {\n  if (entries[0].isIntersecting) {\n    addMoreCards();\n  }\n}\nfunction onFetchError(err) {\n  clearMarkup();\n  Notify.failure(err.message);\n}\n\nasync function addMoreCards() {\n  cardsAPI.page += 1;\n\n  const res = await cardsAPI.getCards();\n\n  renderMarkup(res.hits);\n\n  if (cardsAPI.page === totalPages) {\n    observer.unobserve(refs.addMoreBtn);\n\n    Notify.info(`We're sorry, but you've reached the end of search results.`);\n  }\n}\nfunction clearMarkup() {\n  refs.cardContainer.innerHTML = '';\n}\nfunction renderMarkup(data) {\n  const markup = data.map(card => galleryCardTmplt(card)).join('');\n  refs.cardContainer.insertAdjacentHTML('beforeend', markup);\n  let gallery = new SimpleLightbox('.gallery a', {\n    captionsData: 'alt',\n    captionDelay: '250',\n  });\n  gallery.refresh();\n}\n"],"names":["$22b277e67ad1df42$var$refs","searchFormEl","document","querySelector","cardContainer","addMoreBtn","classList","add","$22b277e67ad1df42$var$observer","IntersectionObserver","entries","isIntersecting","async","$22b277e67ad1df42$var$cardsAPI","page","$22b277e67ad1df42$var$renderMarkup","getCards","hits","$22b277e67ad1df42$var$totalPages","unobserve","$7Y9D8","Notify","info","$22b277e67ad1df42$var$addMoreCards","root","rootMargin","threshold","$k0Hlu","CardsAPI","$22b277e67ad1df42$var$clearMarkup","innerHTML","data","markup","map","card","$5GVQI","default","join","insertAdjacentHTML","$parcel$interopDefault","$fZKcF","captionsData","captionDelay","refresh","addEventListener","e","preventDefault","query","target","elements","searchQuery","value","res","total","Error","Math","ceil","totalHits","success","reset","observe","$22b277e67ad1df42$var$onFetchSucces","err","failure","message","$22b277e67ad1df42$var$onFetchError"],"version":3,"file":"inf-scroll.66d1189a.js.map"}